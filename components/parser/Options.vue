<script setup lang="ts">
import { rawOptions } from '~/state/parser/options'
import { currentParsers } from '~/state/parser/parser'
defineOptions({ inheritAttrs: false })

// const { currentParser } = inject(injectProps)

const dialog = ref<HTMLDialogElement>()

function openDialog() {
  dialog.value?.showModal()
}

function handleDialogClick(evt: MouseEvent) {
  if (evt.target === evt.currentTarget) dialog.value?.close()
}
</script>

<template>
  <div flex="~ center">
    <button v-bind="$attrs" @click="openDialog">
      <div i-ri:settings-line />
    </button>
    <dialog ref="dialog" h-80vh flex-col border rounded-2xl open:flex backdrop:bg-black:30 backdrop:backdrop-blur-2
      @click="handleDialogClick">
      <div flex="~ center" relative gap1 py2 font-bold>
        <span text-lg font-bold>Parser Options</span>
        <button absolute right-2 nav-button @click="dialog?.close()">
          <div i-ri:close-line />
        </button>
      </div>

      <CodeEditor v-model="rawOptions" min-h-0 w-60vw flex-1 :language="currentParser.options.editorLanguage" />
    </dialog>
  </div>
</template>
